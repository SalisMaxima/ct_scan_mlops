# Training configuration
max_epochs: 50
min_epochs: 10

# Loss function configuration
# Options: cross_entropy, focal, weighted_ce, label_smoothing, pairwise_confusion
loss:
  type: cross_entropy
  # Focal loss settings (used when type: focal)
  gamma: 2.0
  # Class weights: [adenocarcinoma, large_cell, squamous_cell, normal]
  # Higher weights increase focus on that class during training
  # Squamous has highest error rate, so can boost its weight
  class_weights: null  # e.g., [1.0, 1.0, 1.3, 0.7]
  # Label smoothing (used when type: label_smoothing)
  smoothing: 0.1
  # Pairwise confusion penalty (used when type: pairwise_confusion)
  confusion_pairs: [[0, 2], [2, 0]]  # adeno <-> squamous
  penalty_weight: 0.5

# Profiling (used once at epoch 0 / batch 0)
# Useful for debugging performance, but can slow down sweeps.
profiling:
  enabled: true
  steps: 5

# Optimizer
optimizer:
  name: adam
  lr: 0.001
  weight_decay: 0.0001
  betas: [0.9, 0.999]

# Learning rate scheduler
scheduler:
  name: cosine
  T_max: ${train.max_epochs}
  eta_min: 0.00001

# Early stopping (disabled by default, enable with early_stopping.enabled=true)
early_stopping:
  enabled: false
  monitor: val_loss
  patience: 10
  mode: min

# Checkpointing
checkpoint:
  monitor: val_acc
  mode: max
  save_top_k: 3
  save_last: true

# Gradient settings (0 = disabled, set to 1.0 to enable clipping)
gradient_clip_val: 0
accumulate_grad_batches: 1

# Hardware
accelerator: auto # auto, gpu, cpu, mps
devices: 1
precision: 32 # 16, 32, bf16
